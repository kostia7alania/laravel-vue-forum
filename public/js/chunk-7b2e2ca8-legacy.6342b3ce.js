(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b2e2ca8"],{"3a2f":function(t,e,n){"use strict";n("9734");var i=n("4ad4"),o=n("a9ad"),a=n("16b7"),r=n("b848"),s=n("75eb"),c=n("f573"),l=n("f2e7"),u=n("80d2"),d=n("d9bd"),p=n("58df");function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}e["a"]=Object(p["a"])(o["a"],a["a"],r["a"],s["a"],c["a"],l["a"]).extend({name:"v-tooltip",props:{closeDelay:{type:[Number,String],default:0},debounce:{type:[Number,String],default:0},disabled:Boolean,fixed:{type:Boolean,default:!0},openDelay:{type:[Number,String],default:0},openOnHover:{type:Boolean,default:!0},tag:{type:String,default:"span"},transition:String,zIndex:{default:null}},data:function(){return{calculatedMinWidth:0,closeDependents:!1}},computed:{calculatedLeft:function(){var t=this.dimensions,e=t.activator,n=t.content,i=!this.bottom&&!this.left&&!this.top&&!this.right,o=!1!==this.attach?e.offsetLeft:e.left,a=0;return this.top||this.bottom||i?a=o+e.width/2-n.width/2:(this.left||this.right)&&(a=o+(this.right?e.width:-n.width)+(this.right?10:-10)),this.nudgeLeft&&(a-=parseInt(this.nudgeLeft)),this.nudgeRight&&(a+=parseInt(this.nudgeRight)),this.calcXOverflow(a,this.dimensions.content.width)+"px"},calculatedTop:function(){var t=this.dimensions,e=t.activator,n=t.content,i=!1!==this.attach?e.offsetTop:e.top,o=0;return this.top||this.bottom?o=i+(this.bottom?e.height:-n.height)+(this.bottom?10:-10):(this.left||this.right)&&(o=i+e.height/2-n.height/2),this.nudgeTop&&(o-=parseInt(this.nudgeTop)),this.nudgeBottom&&(o+=parseInt(this.nudgeBottom)),this.calcYOverflow(o+this.pageYOffset)+"px"},classes:function(){return{"v-tooltip--top":this.top,"v-tooltip--right":this.right,"v-tooltip--bottom":this.bottom,"v-tooltip--left":this.left}},computedTransition:function(){return this.transition?this.transition:this.isActive?"scale-transition":"fade-transition"},offsetY:function(){return this.top||this.bottom},offsetX:function(){return this.left||this.right},styles:function(){return{left:this.calculatedLeft,maxWidth:Object(u["e"])(this.maxWidth),minWidth:Object(u["e"])(this.minWidth),opacity:this.isActive?.9:0,top:this.calculatedTop,zIndex:this.zIndex||this.activeZIndex}}},beforeMount:function(){var t=this;this.$nextTick(function(){t.value&&t.callActivate()})},mounted:function(){"v-slot"===Object(u["p"])(this,"activator",!0)&&Object(d["a"])("v-tooltip's activator slot must be bound, try '<template #activator=\"data\"><v-btn v-on=\"data.on>'",this)},methods:{activate:function(){this.updateDimensions(),requestAnimationFrame(this.startTransition)},deactivate:function(){this.runDelay("close")},genActivatorListeners:function(){var t=this,e=i["a"].options.methods.genActivatorListeners.call(this);return e.focus=function(e){t.getActivator(e),t.runDelay("open")},e.blur=function(e){t.getActivator(e),t.runDelay("close")},e.keydown=function(e){e.keyCode===u["s"].esc&&(t.getActivator(e),t.runDelay("close"))},e}},render:function(t){var e,n=t("div",this.setBackgroundColor(this.color,{staticClass:"v-tooltip__content",class:(e={},h(e,this.contentClass,!0),h(e,"menuable__content__active",this.isActive),h(e,"v-tooltip__content--fixed",this.activatorFixed),e),style:this.styles,attrs:this.getScopeIdAttrs(),directives:[{name:"show",value:this.isContentActive}],ref:"content"}),this.showLazyContent(this.getContentSlot()));return t(this.tag,{staticClass:"v-tooltip",class:this.classes},[t("transition",{props:{name:this.computedTransition}},[n]),this.genActivator()])}})},"3a83":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?n("div",{staticClass:"text-xs-center"},[n("v-progress-circular",{attrs:{size:70,width:7,color:"purple",indeterminate:""}})],1):t.question?n("div",[t.editing?n("question-edit",{attrs:{question:t.question}}):n("question-show",{attrs:{question:t.question}})],1):t._e(),t.question?n("v-container",[n("replies"),n("new-reply")],1):t._e()],1)},o=[],a=n("cebc"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-card",[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.update(e)}}},[n("v-text-field",{attrs:{label:"Title",type:"text",required:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title","string"===typeof e?e.trim():e)},expression:"form.title"}}),n("markdown-editor",{model:{value:t.form.body,callback:function(e){t.$set(t.form,"body","string"===typeof e?e.trim():e)},expression:"form.body"}}),n("v-card-actions",{staticClass:"text-xs-center d-flex align-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({attrs:{color:"primary",type:"submit"}},i),[n("v-icon",{attrs:{color:"orange"}},[t._v("save")]),t._v("\n                             Сохранить\n                         ")],1)]}}])},[n("span",[t._v("Сохранить правки")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({attrs:{color:"primary",dark:""},on:{click:t.cancel}},i),[n("v-icon",{attrs:{color:"red"}},[t._v("cancel")]),t._v("\n                             Отменить\n                         ")],1)]}}])},[n("span",[t._v("Выйти без сохранения")])])],1)],1)],1)],1)},s=[],c=n("2f62"),l={name:"edit-question",props:["question"],data:function(){return{form:{title:null,body:null}}},mounted:function(){this.form=this.question},methods:Object(a["a"])({},Object(c["b"])(["question/questionUpdate"]),{cancel:function(){EventBus.$emit("cancelEditing")},update:function(){var t=this;this["question/questionUpdate"](this.form).then(function(e){return t.cancel()}).catch(function(t){return console.warn(t)})}})},u=l,d=n("2877"),p=n("6544"),h=n.n(p),f=n("8336"),v=n("b0af"),b=n("99d9"),m=n("a523"),g=n("4bd4"),_=n("132d"),y=n("8654"),E=n("3a2f"),k=Object(d["a"])(u,r,s,!1,null,null,null),x=k.exports;h()(k,{VBtn:f["a"],VCard:v["a"],VCardActions:b["a"],VContainer:m["a"],VForm:g["a"],VIcon:_["a"],VTextField:y["a"],VTooltip:E["a"]});var T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-container",{attrs:{fluid:""}},[n("v-card-title",[n("div",[n("div",{staticClass:"headline"},[t._v("\n                    "+t._s(t.question.title)+"\n                ")])]),n("v-spacer"),n("v-btn",{attrs:{color:"teal",dark:""}},[t._v(t._s(t.replyCount)+" Комментариев")])],1),n("v-card-text",{domProps:{innerHTML:t._s(t.body)}}),n("user-info",{attrs:{question:t.question}}),t.own?n("v-card-actions",{staticClass:"text-xs-center d-flex align-center"},[n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({attrs:{color:"primary"},on:{click:t.edit}},i),[n("v-icon",{attrs:{color:"orange"}},[t._v("edit")]),t._v("\n                            Редактировать\n                        ")],1)]}}],null,!1,2968133587)},[n("span",[t._v("Редактировать тему")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("v-btn",t._g({attrs:{color:"primary",dark:""},on:{click:t.destroy}},i),[n("v-icon",{attrs:{color:"red"}},[t._v("delete")]),t._v("\n                            Удалить\n                        ")],1)]}}],null,!1,3360719560)},[n("span",[t._v("Удалить тему")])])],1):t._e()],1)],1)},w=[],O=n("8dba"),C={name:"forum--question-show",components:{"user-info":O["a"]},props:["question"],data:function(){return{replyCount:this.question.reply_count}},computed:Object(a["a"])({},Object(c["c"])(["login/id"]),{own:function(){return this["login/id"]==this.question.id},body:function(){return md.parse(this.question.body)}}),created:function(){var t=this;Echo.private("App.User."+this["login/id"]).notification(function(e){t.replyCount++}),EventBus.$on("deleteReply",function(){t.replyCount--}),Echo.channel("deleteReplyChannel").listen("DeleteReplyEvent",function(e){t.replyCount--})},methods:{destroy:function(){var t=this;axios.delete("/question/".concat(this.question.slug)).then(function(e){t.$router.push("/forum")}).catch(function(t){console.warn("err",t.response.data)})},edit:function(){EventBus.$emit("startEditing")}}},I=C,q=n("e99f"),R=n("9910"),j=Object(d["a"])(I,T,w,!1,null,null,null),V=j.exports;h()(j,{VBtn:f["a"],VCard:v["a"],VCardActions:b["a"],VCardText:q["a"],VCardTitle:b["b"],VContainer:m["a"],VIcon:_["a"],VSpacer:R["a"],VTooltip:E["a"]});var D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{color:"cyan",dark:"",dense:""}},[n("v-toolbar-title",[t._v("Комментарии ("+t._s(t.replies_length)+")\n                    "),t.loading?n("v-progress-circular",{attrs:{size:20,width:3,color:"purple",indeterminate:""}}):t._e()],1)],1),t._l(t.GETTER_TOPIC_REPLIES,function(t,e){return n("reply",{key:t.id,attrs:{data:t,index:e}})})],2)},S=[],$=n("5d58"),A=n.n($),L=n("67bb"),P=n.n(L);function B(t){return B="function"===typeof P.a&&"symbol"===typeof A.a?function(t){return typeof t}:function(t){return t&&"function"===typeof P.a&&t.constructor===P.a&&t!==P.a.prototype?"symbol":typeof t},B(t)}function F(t){return F="function"===typeof P.a&&"symbol"===B(A.a)?function(t){return B(t)}:function(t){return t&&"function"===typeof P.a&&t.constructor===P.a&&t!==P.a.prototype?"symbol":B(t)},F(t)}n("96cf");var z=n("3b8d"),G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[n("v-card",[n("v-card-title",[n("user-info",{attrs:{question:t.data}}),n("v-spacer"),n("Like",{attrs:{content:t.data}})],1),n("v-divider"),t.editing?n("edit-reply",{attrs:{data:t.data}}):n("v-card-text",{domProps:{innerHTML:t._s(t.reply)}}),n("v-divider"),t.editing?t._e():n("div",[t.own?n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:""},on:{click:t.edit}},[n("v-icon",{attrs:{color:"orange"}},[t._v("edit")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.destroy}},[n("v-icon",{attrs:{color:"red"}},[t._v("delete")])],1)],1):t._e()],1)],1)],1)},H=[],M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("markdown-editor",{model:{value:t.data.reply,callback:function(e){t.$set(t.data,"reply",e)},expression:"data.reply"}}),n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:""},on:{click:t.update}},[n("v-icon",{attrs:{color:"green"}},[t._v("save")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.cancel}},[n("v-icon",{attrs:{color:"black"}},[t._v("cancel")])],1)],1)],1)},N=[],W={props:["data"],methods:{update:function(){var t=this;axios.patch("/question/".concat(this.data.question_slug,"/reply/").concat(this.data.id),{body:this.data.reply}).then(function(e){t.cancel()}).catch(function(t){return console.warn(t)})},cancel:function(){EventBus.$emit("cancelEditing")}}},Q=W,U=Object(d["a"])(Q,M,N,!1,null,null,null),Y=U.exports;h()(U,{VBtn:f["a"],VCardActions:b["a"],VIcon:_["a"]});var J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-btn",{attrs:{icon:""},on:{click:t.likeIt}},[n("v-icon",{attrs:{color:t.liked?"red":"red lighten-4"}},[t._v("favorite")]),t._v(" "+t._s(t.count)+"\n    ")],1)],1)},X=[],Z={props:["content"],data:function(){return{liked:this.content.liked,count:this.content.like_count}},created:function(){var t=this;Echo.channel("likeChannel").listen("LikeEvent",function(e){console.log(e),t.content.id==e.id&&(1==e.type?t.count++:t.count--)})},computed:Object(a["a"])({},Object(c["c"])(["login/loggedIn"])),methods:{likeIt:function(){this["login/loggedIn"]?(this.liked?this.decr():this.incr(),this.liked=!this.liked):snack("Для выполнения этого действия нужна авторизация!")},incr:function(){var t=this;axios.post("/like/".concat(this.content.id)).then(function(e){return t.count++}).catch(function(t){return console.warn(t)})},decr:function(){var t=this;axios.delete("/like/".concat(this.content.id)).then(function(e){return t.count--}).catch(function(t){return console.warn(t)})}}},K=Z,tt=Object(d["a"])(K,J,X,!1,null,null,null),et=tt.exports;h()(tt,{VBtn:f["a"],VIcon:_["a"]});var nt={name:"reply",props:["data","index"],components:{editReply:Y,Like:et,"user-info":O["a"]},data:function(){return{editing:!1}},computed:Object(a["a"])({},Object(c["c"])(["login/id","login/loggedIn"]),{own:function(){return this["login/id"]==this.data.user_id},reply:function(){return md.parse(this.data.reply)},created_at:function(){return this.parseDate(this.data.created_at)},updated_at:function(){return this.parseDate(this.data.updated_at)},show_updated_at:function(){return new Date(this.data.updated_at)&&"Invalid Date"!=new Date(this.data.updated_at)&&+new Date(this.data.created_at)!=+new Date(this.data.updated_at)}}),created:function(){this.listen()},methods:{parseDate:function(t){return"Invalid Date"!=t.toLocaleString()?t.toLocaleString():""},destroy:function(){EventBus.$emit("deleteReply",this.index)},edit:function(){this.editing=!0},listen:function(){var t=this;EventBus.$on("cancelEditing",function(){t.editing=!1})}}},it=nt,ot=n("ce7e6"),at=Object(d["a"])(it,G,H,!1,null,null,null),rt=at.exports;h()(at,{VBtn:f["a"],VCard:v["a"],VCardActions:b["a"],VCardText:q["a"],VCardTitle:b["b"],VDivider:ot["a"],VIcon:_["a"],VSpacer:R["a"]});var st={name:"REPLIES",components:{reply:rt},data:function(){return{content:null}},mounted:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.listen(),t.next=3,this["reply/getReplies"]();case 3:e=t.sent,e&&e.stat?snack("Комментарии обновлены!","success"):snack("Комментарии не получены.\n    ".concat("object"==F(e)&&e.msg||""),"error");case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:Object(a["a"])({},Object(c["c"])(["login/id","reply/GETTER_TOPIC_REPLIES","reply/loading"]),{GETTER_TOPIC_REPLIES:function(){return this["reply/GETTER_TOPIC_REPLIES"]},loading:function(){return this["reply/loading"]},replies_length:function(){return this.GETTER_TOPIC_REPLIES&&this.GETTER_TOPIC_REPLIES.length||0}}),methods:Object(a["a"])({},Object(c["b"])(["reply/getReplies"]),{listen:function(){var t=this;EventBus.$on("deleteReply",function(e){axios.delete("question/".concat(t.question.slug,"/reply/").concat(t.content[e].id)).then(function(n){t.content.splice(e,1)}).catch(function(t){return console.warn(t)})}),Echo.private("App.User."+this["login/id"]).notification(function(e){console.log("NOTIF->",e,e.type),t.content.unshift(e.reply)}),Echo.channel("deleteReplyChannel").listen("DeleteReplyEvent",function(e){console.log("DeleteReplyEvent=>",e);for(var n=0;n<t.content.length;n++)t.content[n].id==e.id&&t.content.splice(n,1)})}})},ct=st,lt=n("490a"),ut=n("2a7f"),dt=Object(d["a"])(ct,D,S,!1,null,null,null),pt=dt.exports;h()(dt,{VProgressCircular:lt["a"],VToolbar:ut["a"],VToolbarTitle:ut["b"]});var ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-4"},[n("markdown-editor",{ref:"mark",model:{value:t.body,callback:function(e){t.body="string"===typeof e?e.trim():e},expression:"body"}}),t.loggedIn?n("v-btn",{attrs:{dark:"",disabled:!t.body.length,color:"green"},on:{click:t.submit}},[n("v-icon",[t._v("reply")]),t._v(" Ответить\n    ")],1):n("v-btn",{attrs:{dark:"",to:"/login",disabled:!t.body.length,color:"green"}},[t._v("Войдите, чтобы оставить комментарий ")])],1)},ft=[],vt={name:"new-Reply",data:function(){return{body:""}},mounted:function(){var t=this;this.$refs.mark.simplemde.codemirror.on("blur",function(e,n){console.log("blur=>",t.body),t["reply/SET_TOPIC_DRAFT"](t.body)});var e=this["reply/GETTER_TOPIC_DRAFT"];this.body=e},computed:Object(a["a"])({},Object(c["c"])(["login/loggedIn","reply/GETTER_TOPIC_DRAFT"]),{loggedIn:function(){return this["login/loggedIn"]}}),methods:Object(a["a"])({},Object(c["d"])(["reply/SET_TOPIC_DRAFT"]),Object(c["b"])(["reply/newReply"]),{submit:function(){var t=Object(z["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this["reply/newReply"]({body:this.body});case 2:if(e=t.sent,console.log("comm =>",e),"object"==F(e)){t.next=6;break}return t.abrupt("return",snack("Ошибка при отправке комменатрия","danger"));case 6:if(e.state){t.next=8;break}return t.abrupt("return",snack("Ошибка при отправке комменатрия: "+e.msg,"danger"));case 8:snack("Комменатрий успешно отправлен: "+e.msg,"success"),this.body="";case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()})},bt=vt,mt=Object(d["a"])(bt,ht,ft,!1,null,null,null),gt=mt.exports;h()(mt,{VBtn:f["a"],VIcon:_["a"]});var _t={components:{QuestionEdit:x,QuestionShow:V,replies:pt,NewReply:gt},data:function(){return{question:null,editing:null,loading:!1}},created:function(){this.listen(),this.getQuestion()},computed:Object(a["a"])({},Object(c["c"])(["login/loggedIn"])),methods:{listen:function(){var t=this;EventBus.$on("startEditing",function(){t.editing=!0}),EventBus.$on("cancelEditing",function(){t.editing=!1})},getQuestion:function(){var t=this;this.loading=!0,axios.get("/question/".concat(this.$route.params.slug)).then(function(e){t.question=e.data.data}).finally(function(){return t.loading=!1})}}},yt=_t,Et=Object(d["a"])(yt,i,o,!1,null,null,null);e["default"]=Et.exports;h()(Et,{VContainer:m["a"],VProgressCircular:lt["a"]})},"5d58":function(t,e,n){t.exports=n("d8d6")},"67bb":function(t,e,n){t.exports=n("f921")},"69d3":function(t,e,n){n("6718")("asyncIterator")},"765d":function(t,e,n){n("6718")("observable")},"8dba":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"body-1",attrs:{"grey--text":""}},[n("v-icon",{attrs:{size:"20"}},[t._v("account_circle")]),t._v("\n        "+t._s(t.question.user)+"\n        "),n("v-icon",{attrs:{size:"20"}},[t._v("date_range")]),t._v("\n    "+t._s(t.created_at)+"\n\n    "),t.updated_at?n("v-tooltip",{staticClass:"pl-2",attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[n("span",t._g({},i),[n("v-icon",{attrs:{size:"20"}},[t._v("border_color")])],1)]}}],null,!1,2265665325)},[n("span",[t._v("Обновлен: "+t._s(t.updated_at))])]):t._e()],1)},o=[],a={name:"user-info",props:{question:Object},methods:{toHumanDateTime:function(t){var e=new Date(t);return"Invalid Date"==e?"n/a":"".concat(e.getDate(),".").concat(e.getMonth()+1,".").concat(e.getFullYear()," ").concat(e.getHours(),":").concat(e.getMinutes())}},computed:{created_at:function(){return this.toHumanDateTime(this.question.created_at)},updated_at:function(){if(!this.question||!this.question.updated_at)return!1;var t=new Date(this.question.updated_at),e=new Date(this.question.created_at);return+e!=+t&&this.toHumanDateTime(t)}}},r=a,s=n("2877"),c=n("6544"),l=n.n(c),u=n("132d"),d=n("3a2f"),p=Object(s["a"])(r,i,o,!1,null,null,null);e["a"]=p.exports;l()(p,{VIcon:u["a"],VTooltip:d["a"]})},9734:function(t,e,n){},d8d6:function(t,e,n){n("1654"),n("6c1c"),t.exports=n("ccb9").f("iterator")},f921:function(t,e,n){n("014b"),n("c207"),n("69d3"),n("765d"),t.exports=n("584a").Symbol}}]);
//# sourceMappingURL=chunk-7b2e2ca8-legacy.6342b3ce.js.map