(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c42ff"],{"3a83":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?n("div",{staticClass:"text-xs-center"},[n("v-progress-circular",{attrs:{size:70,width:7,color:"purple",indeterminate:""}})],1):t.question?n("div",[t.editing?n("question-edit",{attrs:{question:t.question}}):n("question-show",{attrs:{question:t.question}})],1):t._e(),t.question?n("v-container",[n("replies"),n("new-reply")],1):t._e()],1)},o=[],r=n("cebc"),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-card",[n("v-form",{on:{submit:function(e){return e.preventDefault(),t.update(e)}}},[n("v-text-field",{attrs:{label:"Title",type:"text",required:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title","string"===typeof e?e.trim():e)},expression:"form.title"}}),n("markdown-editor",{model:{value:t.form.body,callback:function(e){t.$set(t.form,"body","string"===typeof e?e.trim():e)},expression:"form.body"}}),n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:"",type:"submit"}},[n("v-icon",{attrs:{color:"teal"}},[t._v("save")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.cancel}},[n("v-icon",[t._v("cancel")])],1)],1)],1)],1)],1)},a=[],s=n("2f62"),l={name:"edit-question",props:["question"],data:function(){return{form:{title:null,body:null}}},mounted:function(){this.form=this.question},methods:Object(r["a"])({},Object(s["b"])(["question/questionUpdate"]),{cancel:function(){EventBus.$emit("cancelEditing")},update:function(){var t=this;this["question/questionUpdate"](this.form).then(function(e){return t.cancel()}).catch(function(t){return console.warn(t)})}})},u=l,d=n("2877"),p=Object(d["a"])(u,c,a,!1,null,null,null),v=p.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-container",{attrs:{fluid:""}},[n("v-card-title",[n("div",[n("div",{staticClass:"headline"},[t._v("\n                    "+t._s(t.question.title)+"\n                ")]),n("div",{attrs:{"grey--text":""}},[n("span",[n("v-icon",{attrs:{size:"16.5"}},[t._v("account_circle")]),t._v("\n                        "+t._s(t.question.user)+"\n                    ")],1),n("span",[n("v-icon",{attrs:{size:"16.5"}},[t._v("date_range")]),t._v("\n                        "+t._s(t.created_at)+"\n                    ")],1)])]),n("v-spacer"),n("v-btn",{attrs:{color:"teal",dark:""}},[t._v(t._s(t.replyCount)+" Replies")])],1),n("v-card-text",{domProps:{innerHTML:t._s(t.body)}}),t.own?n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:""},on:{click:t.edit}},[n("v-icon",{attrs:{color:"orange"}},[t._v("edit")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.destroy}},[n("v-icon",{attrs:{color:"red"}},[t._v("delete")])],1)],1):t._e()],1)],1)},f=[],m={name:"forum-show-question",props:["question"],data:function(){return{replyCount:this.question.reply_count}},computed:Object(r["a"])({},Object(s["c"])(["login/id"]),{own:function(){return this["login/id"]==this.question.id},body:function(){return md.parse(this.question.body)},created_at:function(){return new Date(this.question.created_at).toLocaleString()}}),created:function(){var t=this;Echo.private("App.User."+this["login/id"]).notification(function(e){t.replyCount++}),EventBus.$on("deleteReply",function(){t.replyCount--}),Echo.channel("deleteReplyChannel").listen("DeleteReplyEvent",function(e){t.replyCount--})},methods:{destroy:function(){var t=this;axios.delete("/question/".concat(this.question.slug)).then(function(e){t.$router.push("/forum")}).catch(function(t){console.warn("err",t.response.data)})},edit:function(){EventBus.$emit("startEditing")}}},g=m,_=Object(d["a"])(g,h,f,!1,null,null,null),b=_.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-toolbar",{attrs:{color:"cyan",dark:"",dense:""}},[n("v-toolbar-title",[t._v("Комментарии ("+t._s(t.replies_length)+")\n                    "),t.loading?n("v-progress-circular",{attrs:{size:20,width:3,color:"purple",indeterminate:""}}):t._e()],1)],1),t._l(t.GETTER_TOPIC_REPLIES,function(t,e){return n("reply",{key:t.id,attrs:{data:t,index:e}})})],2)},E=[],k=n("7618"),O=(n("96cf"),n("3b8d")),R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-3"},[n("v-card",[n("v-card-title",[n("div",{staticClass:"headline"},[t._v(t._s(t.data.user))]),n("div",{staticClass:"md-2"},[t._v("написал  "+t._s(t.created_at))]),n("v-spacer"),n("Like",{attrs:{content:t.data}})],1),n("v-divider"),t.editing?n("edit-reply",{attrs:{data:t.data}}):n("v-card-text",{domProps:{innerHTML:t._s(t.reply)}}),n("v-divider"),t.editing?t._e():n("div",[t.own?n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:""},on:{click:t.edit}},[n("v-icon",{attrs:{color:"orange"}},[t._v("edit")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.destroy}},[n("v-icon",{attrs:{color:"red"}},[t._v("delete")])],1)],1):t._e()],1)],1)],1)},w=[],T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("markdown-editor",{model:{value:t.data.reply,callback:function(e){t.$set(t.data,"reply",e)},expression:"data.reply"}}),n("v-card-actions",[n("v-btn",{attrs:{icon:"",small:""},on:{click:t.update}},[n("v-icon",{attrs:{color:"green"}},[t._v("save")])],1),n("v-btn",{attrs:{icon:"",small:""},on:{click:t.cancel}},[n("v-icon",{attrs:{color:"black"}},[t._v("cancel")])],1)],1)],1)},q=[],x={props:["data"],methods:{update:function(){var t=this;axios.patch("/question/".concat(this.data.question_slug,"/reply/").concat(this.data.id),{body:this.data.reply}).then(function(e){t.cancel()}).catch(function(t){return console.warn(t)})},cancel:function(){EventBus.$emit("cancelEditing")}}},j=x,I=Object(d["a"])(j,T,q,!1,null,null,null),C=I.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-btn",{attrs:{icon:""},on:{click:t.likeIt}},[n("v-icon",{attrs:{color:t.liked?"red":"red lighten-4"}},[t._v("favorite")]),t._v(" "+t._s(t.count)+"\n    ")],1)],1)},P=[],L={props:["content"],data:function(){return{liked:this.content.liked,count:this.content.like_count}},created:function(){var t=this;Echo.channel("likeChannel").listen("LikeEvent",function(e){console.log(e),t.content.id==e.id&&(1==e.type?t.count++:t.count--)})},computed:Object(r["a"])({},Object(s["c"])(["login/loggedIn"])),methods:{likeIt:function(){this["login/loggedIn"]&&(this.liked?this.decr():this.incr(),this.liked=!this.liked)},incr:function(){var t=this;axios.post("/like/".concat(this.content.id)).then(function(e){return t.count++}).catch(function(t){return console.warn(t)})},decr:function(){var t=this;axios.delete("/like/".concat(this.content.id)).then(function(e){return t.count--}).catch(function(t){return console.warn(t)})}}},D=L,S=Object(d["a"])(D,$,P,!1,null,null,null),B=S.exports,G={name:"reply",props:["data","index"],components:{editReply:C,Like:B},data:function(){return{editing:!1}},computed:Object(r["a"])({},Object(s["c"])(["login/id","login/loggedIn"]),{own:function(){return this["login/id"]==this.data.user_id},reply:function(){return md.parse(this.data.reply)},created_at:function(){var t=new Date(this.data.created_at).toLocaleString();return"Invalid Date"!=t?t:""}}),created:function(){this.listen()},methods:{destroy:function(){EventBus.$emit("deleteReply",this.index)},edit:function(){this.editing=!0},listen:function(){var t=this;EventBus.$on("cancelEditing",function(){t.editing=!1})}}},A=G,F=Object(d["a"])(A,R,w,!1,null,null,null),z=F.exports,Q={name:"REPLIES",components:{reply:z},data:function(){return{content:null}},mounted:function(){var t=Object(O["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.listen(),t.next=3,this["reply/getReplies"]();case 3:e=t.sent,e&&e.stat?snack("Комментарии обновлены!","success"):snack("Комментарии не получены.\n    ".concat("object"==Object(k["a"])(e)&&e.msg||""),"error");case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),computed:Object(r["a"])({},Object(s["c"])(["login/id","reply/GETTER_TOPIC_REPLIES","reply/loading"]),{GETTER_TOPIC_REPLIES:function(){return this["reply/GETTER_TOPIC_REPLIES"]},loading:function(){return this["reply/loading"]},replies_length:function(){return this.GETTER_TOPIC_REPLIES&&this.GETTER_TOPIC_REPLIES.length||0}}),methods:Object(r["a"])({},Object(s["b"])(["reply/getReplies"]),{listen:function(){var t=this;EventBus.$on("deleteReply",function(e){axios.delete("/question/".concat(t.question.slug,"/reply/").concat(t.content[e].id)).then(function(n){t.content.splice(e,1)}).catch(function(t){return console.warn(t)})}),Echo.private("App.User."+this["login/id"]).notification(function(e){console.log("NOTIF->",e,e.type),t.content.unshift(e.reply)}),Echo.channel("deleteReplyChannel").listen("DeleteReplyEvent",function(e){console.log("DeleteReplyEvent=>",e);for(var n=0;n<t.content.length;n++)t.content[n].id==e.id&&t.content.splice(n,1)})}})},U=Q,H=Object(d["a"])(U,y,E,!1,null,null,null),N=H.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mt-4"},[n("markdown-editor",{ref:"mark",model:{value:t.body,callback:function(e){t.body="string"===typeof e?e.trim():e},expression:"body"}}),t.loggedIn?n("v-btn",{attrs:{dark:"",disabled:!t.body.length,color:"green"},on:{click:t.submit}},[n("v-icon",[t._v("reply")]),t._v(" Reply ")],1):n("v-btn",{attrs:{dark:"",to:"/login",disabled:!t.body.length,color:"green"}},[t._v(" Log in for reply ")])],1)},M=[],K={name:"new-Reply",data:function(){return{body:""}},mounted:function(){var t=this;this.$refs.mark.simplemde.codemirror.on("blur",function(e,n){console.log("blur=>",t.body),t["reply/SET_TOPIC_DRAFT"](t.body)});var e=this["reply/GETTER_TOPIC_DRAFT"];this.body=e},computed:Object(r["a"])({},Object(s["c"])(["login/loggedIn","reply/GETTER_TOPIC_DRAFT"]),{loggedIn:function(){return this["login/loggedIn"]}}),methods:Object(r["a"])({},Object(s["d"])(["reply/SET_TOPIC_DRAFT"]),Object(s["b"])(["reply/newReply"]),{submit:function(){var t=Object(O["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this["reply/newReply"]({body:this.body});case 2:e=t.sent,e?this.body="":console.log("cant Comment HANDLER");case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()})},V=K,W=Object(d["a"])(V,J,M,!1,null,null,null),X=W.exports,Y={components:{QuestionEdit:v,QuestionShow:b,replies:N,NewReply:X},data:function(){return{question:null,editing:null,loading:!1}},created:function(){this.listen(),this.getQuestion()},computed:Object(r["a"])({},Object(s["c"])(["login/loggedIn"])),methods:{listen:function(){var t=this;EventBus.$on("startEditing",function(){t.editing=!0}),EventBus.$on("cancelEditing",function(){t.editing=!1})},getQuestion:function(){var t=this;this.loading=!0,axios.get("/question/".concat(this.$route.params.slug)).then(function(e){t.question=e.data.data}).finally(function(){return t.loading=!1})}}},Z=Y,tt=Object(d["a"])(Z,i,o,!1,null,null,null);e["default"]=tt.exports}}]);
//# sourceMappingURL=chunk-2d0c42ff.926c5fc7.js.map